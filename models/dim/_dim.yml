# Model tests test that the models produce the right output, they do not test the source data.
models:
  - name: dim_movies
    description: The grain of this table is one unique movie per row.
    columns:
      - name: movieid
        description: Primary key for movies table.
        data_tests:
          - not_null
          - unique
      - name: title
        description: Title of the movie.
        data_tests:
          - not_null
      - name: release_year
        description: Year the movie was released, some movies may not have this information.
      - name: genre_array
        description: Array of genres for the movie.
      - name: latest_review_date
        description: Date of the latest review for the movie, can be null for movies with no reviews.
      - name: first_review_date
        description: Date of the first review for the movie, can be null for movies with no reviews.
      - name: avg_rating
        description: Average rating for the movie.
        data_tests:
          - dbt_utils.expression_is_true:
              arguments:
                expression: "{{ column_name }} BETWEEN 0 AND 5"
      - name: num_ratings
        description: Number of ratings for the movie.
        data_tests:
          - not_null
  - name: dim_users
    description: The grain of this table is one unique user per row.
    columns:
      - name: userid
        description: Primary key for users table.
        data_tests:
          - not_null
          - unique
      - name: first_rating_date
        description: Date of the first review by the user.
        data_tests:
          - not_null
      - name: latest_rating_date
        description: Date of the latest review by the user.
        data_tests:
          - not_null
      - name: avg_rating
        description: Average rating given by the user.
        data_tests:
          - not_null
          - dbt_utils.expression_is_true:
              arguments:
                expression: "{{ column_name }} BETWEEN 0 AND 5"
      - name: num_ratings
        description: Number of ratings given by the user.
        data_tests:
          - not_null
          - dbt_utils.expression_is_true:
              arguments:
                expression: "{{ column_name }} >= 0"
      - name: active_days
        description: Number of days the user has been active.
        data_tests:
          - not_null
          - dbt_utils.expression_is_true:
              arguments:
                expression: "{{ column_name }} >= 0"
